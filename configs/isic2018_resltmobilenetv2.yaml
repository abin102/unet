exp_name: "isic_resltmobilenetv2_reslt"
seed: 42
output_dir: "runs/reslt_runs"

dataset: "isic2018"
data_dir: "./data/isic2018"
batch_size: 128
num_workers: 8
pin_memory: true
persistent_workers: true
image_size: 224
to_rgb: false
imagenet_norm: false

data_args: {}
  # This triggers the new logic. If you remove this line, it runs the old way.

  # imb_factor: 0.01
  # class_balance: false

model: "mobilenetv2_3bhn"
model_args:
  num_classes: 7
  #scale: 1

# Use custom ResLT loss instead of CE
loss: "reslt_loss"
loss_args:
  beta: 0.99  # weight for ICE vs FCE
  head_classes: ["NV"]      # indices of head classes
  medium_classes: ["MEL", "BKL"]    # indices of medium classes
  tail_classes: ["BCC", "AKIEC", "VASC", "DF"]   # indices of tail classes

metrics: ["acc"]   # can extend later with head/medium/tail acc

# optim: "adam"
# optim_args: { lr: 1e-3, weight_decay: 1e-4 }

optim: "sgd"
optim_args:
  lr: 0.1
  momentum: 0.9
  weight_decay: 5.0e-4
  nesterov: true

# scheduler: "cosine"
# scheduler_args: { T_max: 50 }


scheduler: "multistep"
scheduler_args:
  milestones: [160, 180]
  gamma: 0.1
  warmup_epochs: 5     # optional â€” add this to enable the 5-epoch warmup

epochs: 200
amp: false
grad_clip: 0.0
log_interval: 50
val_interval: 1
early_stop: { patience: 15, monitor: "val/acc", mode: "max" }


# logging 
logging:
  debug: false         # for backtracing and diagnosing
  level: INFO          # or DEBUG / WARNING / ERROR
  rotation: 50 MB      # rotate log file when >50MB
  retention: 14 days   # delete older logs
  compression: zip     # compress rotated logs
  tensorboard: false   # disable TB by default
  attention: false     # for saving attention maps

use_wandb: true
wandb:
  project: UGER
  entity: abin24-cids # name-same as project name
  resume: false
